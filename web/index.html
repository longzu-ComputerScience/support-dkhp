<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Support-DKHP | Slot Checker</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <!-- animated background -->
  <div class="bg">
    <div class="blob b1"></div>
    <div class="blob b2"></div>
    <div class="blob b3"></div>
    <div class="grid-noise"></div>
  </div>

  <main class="wrap">
    <header class="hero">
      <div class="brand">
        <div class="logo" aria-hidden="true">SD</div>
        <div class="brandText">
          <h1>Support-DKHP</h1>
          <p class="sub">
            Nh·∫≠p m√£ l·ªõp (m·ªói d√≤ng 1 m√£) ‚Üí b·∫•m <b>Qu√©t</b> (Kh√¥ng c·∫ßn nh·∫≠p m√£ l·ªõp th·ª±c h√†nh).
          </p>
        </div>
      </div>

      <div class="heroRight">
        <div class="chips">
          <span id="chipConn" class="chip">Bridge: ‚Ä¶</span>
          <span id="chipState" class="chip">Idle</span>
          <span id="chipTime" class="chip mono">‚Äî</span>
        </div>

        <div class="heroActions">
          <button id="btnTheme" class="btn ghost" title="S√°ng/T·ªëi">
            <span class="ico">‚òÄÔ∏è</span><span class="ico">üåô</span>
            <span class="txt">Theme</span>
          </button>
        </div>
      </div>
    </header>

    <section class="mainGrid">
      <!-- LEFT: input + settings -->
      <section class="card">
        <div class="cardHead">
          <div>
            <h2>Danh s√°ch m√£ l·ªõp</h2>
            <div class="tiny">M·ªói d√≤ng 1 m√£. M·ªü s·∫µn tab DKHP (ƒëƒÉng nh·∫≠p) tr∆∞·ªõc khi qu√©t.</div>
          </div>
          <span id="pillCount" class="pill mono">0 lines</span>
        </div>

        <textarea id="codes" class="textarea mono" rows="12" placeholder="V√≠ d·ª•:
CS112.Q21.1
CS114.Q21.1
CS116.Q21.1"></textarea>

        <div class="row">
          <button id="btnScan" class="btn primary glow">
            <span class="btnIcon">‚ö°</span>
            <span>Qu√©t</span>
          </button>
          <button id="btnSave" class="btn ghost">
            <span class="btnIcon">üíæ</span>
            <span>L∆∞u</span>
          </button>
          <button id="btnClear" class="btn ghost danger">
            <span class="btnIcon">üßπ</span>
            <span>X√≥a</span>
          </button>
        </div>

        <div class="divider"></div>

        <div class="settings">
          <div class="setting">
            <label class="label">Ch·∫ø ƒë·ªô qu√©t</label>
            <div class="seg">
              <button id="modeOnce" class="segBtn active">1 l·∫ßn</button>
              <button id="modeLoop" class="segBtn">L·∫∑p</button>
            </div>
          </div>

          <div class="setting">
            <label class="label">Chu k·ª≥ (khi L·∫∑p)</label>
            <select id="interval" class="select">
              <option value="1500">1.5s</option>
              <option value="2000" selected>2s</option>
              <option value="3000">3s</option>
              <option value="5000">5s</option>
              <option value="8000">8s</option>
              <option value="12000">12s</option>
            </select>
          </div>

          <div class="setting">
            <label class="label">S·∫Øp x·∫øp</label>
            <select id="sort" class="select">
              <option value="input" selected>Theo th·ª© t·ª± nh·∫≠p</option>
              <option value="left_desc">Slot c√≤n nhi·ªÅu ‚Üí √≠t</option>
              <option value="left_asc">Slot c√≤n √≠t ‚Üí nhi·ªÅu</option>
              <option value="code_asc">M√£ l·ªõp A ‚Üí Z</option>
            </select>
          </div>

          <div class="setting">
            <label class="label">L·ªçc</label>
            <select id="filter" class="select">
              <option value="all" selected>T·∫•t c·∫£</option>
              <option value="has">C√≤n slot (&gt; 0)</option>
              <option value="full">H·∫øt slot (= 0)</option>
              <option value="unknown">Kh√¥ng r√µ (null)</option>
            </select>
          </div>

          <div class="setting">
            <label class="label">T√¨m nhanh</label>
            <input id="q" class="input mono" placeholder="VD: CS112 ho·∫∑c Q21.1" />
          </div>

          <div class="setting">
            <label class="label">Ti·ªán √≠ch</label>
            <div class="row2">
              <button id="btnCsv" class="btn ghost">
                <span class="btnIcon">üìÑ</span><span>CSV</span>
              </button>
              <button id="btnCopy" class="btn ghost">
                <span class="btnIcon">üìã</span><span>Copy</span>
              </button>
              <button id="btnPing" class="btn ghost">
                <span class="btnIcon">üõ∞Ô∏è</span><span>Ping</span>
              </button>
            </div>
          </div>
        </div>

        <div class="hint">
          <b>M·∫πo:</b> N·∫øu ‚ÄúBridge: OFF‚Äù, h√£y reload extension + reload trang web UI.  
          N·∫øu scan b√°o ‚ÄúCh∆∞a m·ªü tab DKHP‚Äù, h√£y m·ªü DKHP trong c√πng c·ª≠a s·ªï Chrome.
        </div>
      </section>

      <!-- RIGHT: stats + results + log -->
      <section class="stack">
        <section class="card stats">
          <div class="stat">
            <div class="statLabel">ƒêang theo d√µi</div>
            <div id="stWatch" class="statVal mono">0</div>
          </div>
          <div class="stat">
            <div class="statLabel">T√¨m th·∫•y</div>
            <div id="stFound" class="statVal mono">0</div>
          </div>
          <div class="stat">
            <div class="statLabel">C√≤n slot</div>
            <div id="stHas" class="statVal mono">0</div>
          </div>
          <div class="stat">
            <div class="statLabel">Best left</div>
            <div id="stBest" class="statVal mono">‚Äî</div>
          </div>
        </section>

        <section class="card">
          <div class="cardHead">
            <div>
              <h2>K·∫øt qu·∫£</h2>
              <div class="tiny">Web s·∫Ω hi·ªÉn th·ªã theo filter/sort/search b·∫°n ch·ªçn.</div>
            </div>
            <span id="pillRows" class="pill mono">0 rows</span>
          </div>

          <div class="tableWrap">
            <table class="table">
              <thead>
                <tr>
                  <th>M√£ l·ªõp</th>
                  <th>C√≤n</th>
                  <th>ƒê√£ ƒêK</th>
                  <th>T·ªëi ƒëa</th>
                  <th>Raw</th>
                </tr>
              </thead>
              <tbody id="tbody">
                <tr><td colspan="5" class="muted">Ch∆∞a c√≥ d·ªØ li·ªáu.</td></tr>
              </tbody>
            </table>
          </div>

          <details class="raw">
            <summary>JSON th√¥</summary>
            <pre id="raw">‚Äî</pre>
          </details>
        </section>

        <section class="card">
          <div class="cardHead">
            <div>
              <h2>Log</h2>
              <div class="tiny">M·ªói l·∫ßn qu√©t s·∫Ω ghi 1 d√≤ng (ƒë·ªÉ debug nhanh).</div>
            </div>
            <button id="btnClearLog" class="btn ghost danger small">X√≥a log</button>
          </div>
          <div id="log" class="log mono"></div>
        </section>
      </section>
    </section>

    <footer class="foot">
      <span class="muted">Client-only web + MV3 bridge</span>
    </footer>
  </main>

  <script src="./app.js"></script>
</body>
</html>
